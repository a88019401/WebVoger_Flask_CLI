<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>ä»¿ ChatGPT å°è©±ä»‹é¢</title>
  <style>
    body { font-family: sans-serif; max-width: 700px; margin: auto; padding: 2rem; background: #f7f7f7; }
    #chatBox div { margin: 10px 0; padding: 10px; border-radius: 8px; }
    .user { background: #d2e3fc; text-align: right; }
    .bot { background: #e2e2e2; text-align: left; }
  </style>
</head>
<body>
  <h1>AI åŠ©æ•™å°è©±ä»‹é¢</h1>
  <div id="chatBox"></div>
  <input id="input" type="text" placeholder="è¼¸å…¥ä»»å‹™å•é¡Œï¼Œå¦‚ï¼šbanana æ˜¯ä»€éº¼æ„æ€" style="width: 70%;">
  <button onclick="sendMessage()">é€å‡º</button>

  <script>async function sendMessage() {
    const input = document.getElementById('input');
    const userInput = input.value.trim();
    if (!userInput) return;
  
    const chatBox = document.getElementById("chatBox");
    chatBox.innerHTML += `<div class="user">ğŸ™‹â€â™‚ï¸ ${userInput}</div>`;
    input.value = '';
  
    const prompt = `è«‹å¹«æˆ‘æŸ¥ '${userInput}' çš„æ„æ€ï¼Œä¸¦çµ¦æˆ‘ä¸€å€‹ä¾‹å¥ã€‚`;
  
    try {
      const res = await fetch('/submit_task', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt }) // âœ… ä¸€å®šè¦æ˜¯ prompt
      });
  
      const data = await res.json();
  
      chatBox.innerHTML += `<div class="bot">ğŸ¤– ${data.response.replaceAll('\\n', '<br>')}</div>`;
  
      if (data.image_path) {
        chatBox.innerHTML += `<img src="${data.image_path}" style="max-width: 100%; margin-top: 1rem;">`;
      }
    } catch (err) {
      chatBox.innerHTML += `<div class="bot">âš ï¸ éŒ¯èª¤ï¼š${err.message}</div>`;
    }
  }
  
  </script>
  
</body>
<!-- æ”¾åœ¨ <head> æˆ– </body> çµå°¾ -->
<script src="{{ url_for('static', filename='js/script.js') }}"></script>

</html>
